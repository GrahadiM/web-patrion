<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Program Detail - PATRION Universe</title>
    <meta name="description" content="Detail lengkap program PATRION dengan informasi produksi, trailer, dan konten terkait">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Program Detail - PATRION Universe">
    <meta property="og:description" content="Detail lengkap program PATRION dengan informasi produksi, trailer, dan konten terkait">
    
    <!-- CSS & Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0f172a',
                        secondary: '#1e293b',
                        accent: '#fbbf24',
                        'fantasy-blue': '#1e3a8a',
                        'fantasy-purple': '#5b21b6',
                        'fantasy-dark': '#0f172a',
                        'fantasy-gold': '#fbbf24',
                        // Warna elemen berdasarkan karakter
                        fire: '#dc2626',
                        wind: '#94a3b8',
                        water: '#3b82f6',
                        earth: '#d97706',
                        thunder: '#7c3aed',
                        nature: '#16a34a',
                        light: '#fde047',
                        dark: '#1e293b'
                    },
                    backgroundImage: {
                        'fantasy-gradient': 'linear-gradient(135deg, #1e3a8a 0%, #5b21b6 50%, #0f172a 100%)',
                        'gold-gradient': 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)'
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="assets/css/styles.css">
    <style>
        .program-hero {
            height: 70vh;
            min-height: 500px;
            position: relative;
            overflow: hidden;
        }
        
        .program-hero::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 150px;
            background: linear-gradient(to top, #000000, transparent);
        }
        
        .tab-button {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button.active {
            border-bottom-color: #fbbf24;
            color: #fbbf24;
        }
        
        .character-card {
            transition: transform 0.3s ease;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(251, 191, 36, 0.1);
        }
        
        .character-card:hover {
            transform: translateY(-5px);
            border-color: rgba(251, 191, 36, 0.3);
        }
        
        .episode-card {
            background: rgba(30, 41, 59, 0.5);
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        
        .episode-card:hover {
            border-left-color: #fbbf24;
            background: rgba(30, 41, 59, 0.8);
        }
        
        .platform-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .platform-netflix { background: #e50914; }
        .platform-disney { background: #113ccf; }
        .platform-youtube { background: #ff0000; }
        .platform-spotify { background: #1db954; }
        .platform-cinema { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.35s;
            transform: rotate(90deg);
            transform-origin: 50% 50%;
        }
        
        /* Custom scrollbar for episode list */
        .episode-list {
            scrollbar-width: thin;
            scrollbar-color: #fbbf24 #1e293b;
        }
        
        .episode-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .episode-list::-webkit-scrollbar-track {
            background: #1e293b;
        }
        
        .episode-list::-webkit-scrollbar-thumb {
            background: #fbbf24;
            border-radius: 4px;
        }
    </style>
</head>
<body class="relative">

    <!-- Background dengan partikel dan efek cahaya -->
    <canvas id="particle-canvas"></canvas>
    <div class="aurora"></div>
    
    <!-- Header & Navigation -->
    <header class="glass-effect sticky top-0 z-50 shadow-lg">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <!-- Logo -->
                <div class="flex items-center">
                    <!-- Gambar logo -->
                    <a href="index.html" class="flex items-center">
                        <img src="assets/images/logo-patrion.png" alt="Logo PATRION" class="w-full h-12">
                    </a>
                </div>
                
                <!-- Desktop Navigation -->
                <nav class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link text-white hover:text-fantasy-gold transition-colors">BERANDA</a>
                    <a href="program.html" class="nav-link text-white hover:text-fantasy-gold transition-colors">PROGRAM</a>
                    
                    <!-- Karakter Dropdown -->
                    <div class="relative group">
                        <a href="characters.html" class="nav-link text-white hover:text-fantasy-gold transition-colors flex items-center">
                            KARAKTER <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </a>
                        <div class="absolute left-[-60%] mt-2 w-56 glass-effect rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50 border border-fantasy-gold/20">
                            <div class="py-2 grid grid-cols-2 gap-1">
                                <a href="character-detail.html?character=kunna" class="flex items-center px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">
                                    <div class="w-3 h-3 rounded-full bg-fire mr-2"></div>
                                    KUNNA
                                </a>
                                <a href="character-detail.html?character=wabu" class="flex items-center px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">
                                    <div class="w-3 h-3 rounded-full bg-fire mr-2"></div>
                                    WABU
                                </a>
                                <a href="character-detail.html?character=asta" class="flex items-center px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">
                                    <div class="w-3 h-3 rounded-full bg-fire mr-2"></div>
                                    ASTA
                                </a>
                                <a href="character-detail.html?character=taran" class="flex items-center px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">
                                    <div class="w-3 h-3 rounded-full bg-fire mr-2"></div>
                                    TARAN
                                </a>
                                <a href="character-detail.html?character=sanu" class="flex items-center px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">
                                    <div class="w-3 h-3 rounded-full bg-fire mr-2"></div>
                                    SANU
                                </a>
                                <a href="character-detail.html?character=kabi" class="flex items-center px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">
                                    <div class="w-3 h-3 rounded-full bg-fire mr-2"></div>
                                    KABI
                                </a>
                                <a href="character-detail.html?character=arun" class="flex items-center px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">
                                    <div class="w-3 h-3 rounded-full bg-fire mr-2"></div>
                                    ARUN
                                </a>
                                <a href="character-detail.html?character=antis" class="flex items-center px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">
                                    <div class="w-3 h-3 rounded-full bg-fire mr-2"></div>
                                    ANTIS
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informasi Dropdown -->
                    <div class="relative group">
                        <a href="javascript:void(0);" class="nav-link text-white hover:text-fantasy-gold transition-colors flex items-center">
                            INFORMASI <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </a>
                        <div class="absolute left-[-80%] mt-2 w-48 glass-effect rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 border border-fantasy-gold/20">
                            <div class="py-2">
                                <a href="about.html" class="block px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">TENTANG PATRION</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Lainnya Dropdown -->
                    <div class="relative group">
                        <a href="javascript:void(0);" class="nav-link text-white hover:text-fantasy-gold transition-colors flex items-center">
                            LAINNYA <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </a>
                        <div class="absolute left-[-100%] mt-2 w-48 glass-effect rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 border border-fantasy-gold/20">
                            <div class="py-2">
                                <a href="javascript:void(0);" class="block px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">KOMIK</a>
                                <a href="javascript:void(0);" class="block px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">NOVEL</a>
                                <a href="javascript:void(0);" class="block px-4 py-2 hover:bg-fantasy-purple/30 transition-colors">GAME</a>
                            </div>
                        </div>
                    </div>
                </nav>
                
                <!-- Mobile Menu Button -->
                <button id="mobile-menu-button" class="md:hidden text-white focus:outline-none">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>

            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="md:hidden mt-4 hidden glass-effect rounded-lg p-4 border border-fantasy-gold/20">
                <div class="flex flex-col space-y-3">
                    <a href="index.html" class="hover:text-fantasy-gold transition-colors py-2">BERANDA</a>
                    <a href="program.html" class="hover:text-fantasy-gold transition-colors py-2">PROGRAM</a>
                    
                    <div class="py-2">
                        <a href="characters.html" class="hover:text-fantasy-gold transition-colors font-semibold">KARAKTER</a>
                        <div class="mt-2 ml-4 grid grid-cols-2 gap-2">
                            <a href="character-detail.html?character=kunna" class="text-sm hover:text-fantasy-gold flex items-center">
                                <div class="w-2 h-2 rounded-full bg-fire mr-2"></div>
                                KUNNA
                            </a>
                            <a href="character-detail.html?character=wabu" class="text-sm hover:text-fantasy-gold flex items-center">
                                <div class="w-2 h-2 rounded-full bg-fire mr-2"></div>
                                WABU
                            </a>
                            <a href="character-detail.html?character=asta" class="text-sm hover:text-fantasy-gold flex items-center">
                                <div class="w-2 h-2 rounded-full bg-fire mr-2"></div>
                                ASTA
                            </a>
                            <a href="character-detail.html?character=taran" class="text-sm hover:text-fantasy-gold flex items-center">
                                <div class="w-2 h-2 rounded-full bg-fire mr-2"></div>
                                TARAN
                            </a>
                            <a href="character-detail.html?character=sanu" class="text-sm hover:text-fantasy-gold flex items-center">
                                <div class="w-2 h-2 rounded-full bg-fire mr-2"></div>
                                SANU
                            </a>
                            <a href="character-detail.html?character=kabi" class="text-sm hover:text-fantasy-gold flex items-center">
                                <div class="w-2 h-2 rounded-full bg-fire mr-2"></div>
                                KABI
                            </a>
                            <a href="character-detail.html?character=arun" class="text-sm hover:text-fantasy-gold flex items-center">
                                <div class="w-2 h-2 rounded-full bg-fire mr-2"></div>
                                ARUN
                            </a>
                            <a href="character-detail.html?character=antis" class="text-sm hover:text-fantasy-gold flex items-center">
                                <div class="w-2 h-2 rounded-full bg-fire mr-2"></div>
                                ANTIS
                            </a>
                        </div>
                    </div>
                    
                    <div class="py-2">
                        <a href="javascript:void(0);" class="hover:text-fantasy-gold transition-colors font-semibold">INFORMASI</a>
                        <div class="mt-2 ml-4 flex flex-col space-y-2">
                            <a href="about.html" class="text-sm hover:text-fantasy-gold">TENTANG PATRION</a>
                        </div>
                    </div>
                    
                    <div class="py-2">
                        <a href="javascript:void(0);" class="hover:text-fantasy-gold transition-colors font-semibold">LAINNYA</a>
                        <div class="mt-2 ml-4 flex flex-col space-y-2">
                            <a href="javascript:void(0);" class="text-sm hover:text-fantasy-gold">KOMIK</a>
                            <a href="javascript:void(0);" class="text-sm hover:text-fantasy-gold">NOVEL</a>
                            <a href="javascript:void(0);" class="text-sm hover:text-fantasy-gold">GAME</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Program Hero -->
    <div class="program-hero">
        <div class="absolute inset-0">
            <img id="heroImage" src="" alt="" class="w-full h-full object-cover">
            <div class="absolute inset-0 bg-gradient-to-t from-black via-black/70 to-transparent"></div>
        </div>
        
        <div class="absolute bottom-0 left-0 right-0 container mx-auto px-4 pb-12 z-10">
            <div class="max-w-4xl">
                <div class="flex items-center space-x-3 mb-4">
                    <span id="platformBadge" class="px-4 py-1 rounded-full text-sm font-semibold"></span>
                    <span id="statusBadge" class="px-4 py-1 rounded-full text-sm font-semibold"></span>
                    <span id="ratingBadge" class="px-4 py-1 rounded-full text-sm font-semibold bg-gray-800/50 text-gray-300"></span>
                </div>
                
                <h1 id="programTitle" class="fantasy-font text-4xl md:text-5xl font-bold text-white mb-4"></h1>
                <p id="programDescription" class="text-gray-300 text-lg mb-6 max-w-3xl"></p>
                
                <div class="flex flex-wrap gap-3">
                    <button id="playTrailerBtn" 
                            class="bg-fantasy-gold hover:bg-yellow-500 text-black font-bold py-3 px-8 rounded-full transition-all transform hover:scale-105">
                        <i class="fas fa-play mr-2"></i> Play Trailer
                    </button>
                    <button id="watchNowBtn" class="border-2 border-fantasy-gold text-fantasy-gold hover:bg-fantasy-gold hover:text-black font-bold py-3 px-8 rounded-full transition-all">
                        <i class="fas fa-eye mr-2"></i> Watch Now
                    </button>
                    <button id="addToListBtn" class="border border-gray-600 text-gray-300 hover:text-white hover:border-gray-500 font-medium py-3 px-6 rounded-full transition-all">
                        <i class="far fa-bookmark mr-2"></i> Add to List
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Tab Navigation -->
        <div class="flex space-x-8 mb-8 border-b border-gray-800">
            <button class="tab-button py-3 font-medium text-gray-400 hover:text-white active" data-tab="overview">
                Overview
            </button>
            <button class="tab-button py-3 font-medium text-gray-400 hover:text-white" data-tab="episodes">
                Episodes
            </button>
            <button class="tab-button py-3 font-medium text-gray-400 hover:text-white" data-tab="characters">
                Characters
            </button>
            <button class="tab-button py-3 font-medium text-gray-400 hover:text-white" data-tab="production">
                Production
            </button>
            <button class="tab-button py-3 font-medium text-gray-400 hover:text-white" data-tab="gallery">
                Gallery
            </button>
        </div>
        
        <!-- Tab Content -->
        <div id="tabContent">
            <!-- Overview Tab -->
            <div id="overviewTab" class="tab-pane active animate-fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2">
                        <h2 class="fantasy-font text-2xl text-white mb-6">Sinopsis</h2>
                        <div id="synopsis" class="text-gray-300 mb-8 leading-relaxed"></div>
                        
                        <div class="mb-8">
                            <h3 class="fantasy-font text-xl text-white mb-4">Trailer</h3>
                            <div class="aspect-video bg-black rounded-xl overflow-hidden">
                                <video id="detailTrailer" class="w-full h-full" controls poster="" preload="metadata">
                                    Your browser does not support the video tag.
                                </video>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="glass-effect rounded-xl p-6 mb-6">
                            <h3 class="fantasy-font text-xl text-white mb-4">Details</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Release Date</span>
                                    <span id="detailReleaseDate" class="text-white font-medium"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Duration</span>
                                    <span id="detailDuration" class="text-white font-medium"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Episodes</span>
                                    <span id="detailEpisodes" class="text-white font-medium"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Language</span>
                                    <span class="text-white font-medium">Indonesian, English Subs</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Budget</span>
                                    <span id="detailBudget" class="text-white font-medium"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="glass-effect rounded-xl p-6">
                            <h3 class="fantasy-font text-xl text-white mb-4">Available On</h3>
                            <div id="platforms" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Featured Characters -->
                <div class="mt-12">
                    <h3 class="fantasy-font text-2xl text-white mb-6">Featured Characters</h3>
                    <div id="featuredCharacters" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
                </div>
            </div>
            
            <!-- Episodes Tab -->
            <div id="episodesTab" class="tab-pane hidden animate-fade-in">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="fantasy-font text-2xl text-white">All Episodes</h2>
                    <div class="flex items-center space-x-2">
                        <span class="text-gray-400">Season:</span>
                        <select id="seasonSelect" class="glass-effect text-white py-2 px-4 rounded-lg">
                            <option value="1">Season 1</option>
                            <option value="2">Season 2 (Coming Soon)</option>
                        </select>
                    </div>
                </div>
                
                <div class="episode-list max-h-[600px] overflow-y-auto pr-4">
                    <div id="episodesList" class="space-y-3"></div>
                </div>
            </div>
            
            <!-- Characters Tab -->
            <div id="charactersTab" class="tab-pane hidden animate-fade-in">
                <h2 class="fantasy-font text-2xl text-white mb-6">Characters in This Program</h2>
                <div id="allCharacters" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"></div>
            </div>
            
            <!-- Production Tab -->
            <div id="productionTab" class="tab-pane hidden animate-fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="fantasy-font text-2xl text-white mb-6">Production Details</h3>
                        <div id="productionDetails" class="space-y-4"></div>
                    </div>
                    
                    <div>
                        <h3 class="fantasy-font text-2xl text-white mb-6">Production Timeline</h3>
                        <div id="productionTimeline" class="space-y-4"></div>
                    </div>
                </div>
                
                <div class="mt-12">
                    <h3 class="fantasy-font text-2xl text-white mb-6">Crew & Cast</h3>
                    <div id="crewList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                </div>
            </div>
            
            <!-- Gallery Tab -->
            <div id="galleryTab" class="tab-pane hidden animate-fade-in">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="fantasy-font text-2xl text-white">Gallery</h2>
                    <div class="flex space-x-2">
                        <button class="filter-gallery active px-4 py-2 rounded-lg bg-fantasy-gold/20 text-fantasy-gold" data-filter="all">
                            All
                        </button>
                        <button class="filter-gallery px-4 py-2 rounded-lg glass-effect text-gray-400 hover:text-white" data-filter="stills">
                            Stills
                        </button>
                        <button class="filter-gallery px-4 py-2 rounded-lg glass-effect text-gray-400 hover:text-white" data-filter="behind">
                            Behind the Scenes
                        </button>
                        <button class="filter-gallery px-4 py-2 rounded-lg glass-effect text-gray-400 hover:text-white" data-filter="concept">
                            Concept Art
                        </button>
                    </div>
                </div>
                
                <div id="galleryGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
            </div>
        </div>
    </main>

    <!-- Related Programs -->
    <section class="py-16 glass-effect mt-12">
        <div class="container mx-auto px-4">
            <h2 class="fantasy-font text-3xl text-white mb-8 text-center">Related Programs</h2>
            <div id="relatedPrograms" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="glass-effect py-12 border-t border-fantasy-gold/20">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <img src="assets/images/logo-patrion.png" alt="Logo PATRION" class="h-12 mb-4">
                    <p class="text-gray-400 text-sm">
                        Dunia fantasi Nusantara dengan kekuatan elemen dan petualangan epik.
                    </p>
                </div>
                
                <div>
                    <h3 class="fantasy-font text-fantasy-gold mb-4">Eksplorasi</h3>
                    <div class="flex flex-col space-y-2">
                        <a href="characters.html" class="text-gray-400 hover:text-fantasy-gold transition-colors">Karakter</a>
                        <a href="program.html" class="text-gray-400 hover:text-fantasy-gold transition-colors">Program</a>
                        <a href="index.html#wahana" class="text-gray-400 hover:text-fantasy-gold transition-colors">Wahana</a>
                    </div>
                </div>
                
                <div>
                    <h3 class="fantasy-font text-fantasy-gold mb-4">Bantuan</h3>
                    <div class="flex flex-col space-y-2">
                        <a href="javascript:void(0);" class="text-gray-400 hover:text-fantasy-gold transition-colors">Pusat Bantuan</a>
                        <a href="javascript:void(0);" class="text-gray-400 hover:text-fantasy-gold transition-colors">Komunitas</a>
                        <a href="javascript:void(0);" class="text-gray-400 hover:text-fantasy-gold transition-colors">Kontak</a>
                    </div>
                </div>
                
                <div>
                    <h3 class="fantasy-font text-fantasy-gold mb-4">Terhubung</h3>
                    <div class="flex space-x-4 mb-4">
                        <a href="https://www.facebook.com/patrion.universe" target="_blank" class="text-gray-400 hover:text-fantasy-gold transition-colors text-xl">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://www.instagram.com/patrionofficial" target="_blank" class="text-gray-400 hover:text-fantasy-gold transition-colors text-xl">
                            <i class="fab fa-square-facebook"></i>
                        </a>
                        <a href="https://www.tiktok.com/@patrionofficial" target="_blank" class="text-gray-400 hover:text-fantasy-gold transition-colors text-xl">
                            <i class="fab fa-tiktok"></i>
                        </a>
                    </div>
                    <div class="text-sm text-gray-400">
                        <p>Email: info@patrion.com</p>
                        <p>Support: support@patrion.com</p>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-700 pt-8 text-center">
                <p class="text-gray-400 text-sm">
                    "Karakter", "Artefak" dan "Alam Semesta Patrion" adalah merek dagang dari <span class="text-fantasy-gold">PATRION</span>.
                    Â© 2024 PATRION. All Rights Reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- Video Modal -->
    <div id="videoModal" class="fixed inset-0 bg-black/90 hidden z-50 flex items-center justify-center">
        <div class="relative w-[90%] max-w-4xl">
            <button id="closeModal" class="absolute -top-12 right-0 text-white text-2xl hover:text-fantasy-gold">
                <i class="fas fa-times"></i>
            </button>
            <div class="aspect-video bg-black rounded-lg overflow-hidden">
                <video id="modalVideo" class="w-full h-full" controls></video>
            </div>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button id="backToTop" class="back-to-top bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-400 text-black font-bold py-1 px-3 rounded-full shadow-lg transform hover:scale-105 transition-all duration-300">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Image Modal -->
    <div id="imageModal" class="fixed inset-0 bg-black/95 hidden z-50 flex items-center justify-center">
        <div class="relative w-[90%] max-w-4xl">
            <button id="closeImageModal" class="absolute -top-12 right-0 text-white text-2xl hover:text-fantasy-gold">
                <i class="fas fa-times"></i>
            </button>
            <img id="modalImage" src="" alt="" class="w-full h-auto rounded-lg">
            <div id="imageCaption" class="text-white mt-4 text-center"></div>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" rel="noopener noreferrer"></script>
    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js" rel="noopener noreferrer"></script>
    <!-- Custom JS -->
    <script src="assets/js/shared-api.js"></script>
    <!-- Ganti script program-detail.html dengan ini -->

    <script>
        // Deklarasikan semua fungsi terlebih dahulu
        function updatePageContent(program) {
            // Update page title
            document.title = `${program.title} - Program Detail | PATRION`;
            
            // Update meta tags for SEO
            updateMetaTags(program);
            
            // Update hero section
            updateHeroSection(program);
            
            // Update overview tab
            updateOverviewTab(program);
        }

        function updateMetaTags(program) {
            // Update Open Graph tags
            const ogTitle = document.querySelector('meta[property="og:title"]');
            const ogDescription = document.querySelector('meta[property="og:description"]');
            const ogImage = document.querySelector('meta[property="og:image"]');
            
            if (ogTitle) ogTitle.setAttribute('content', `${program.title} - PATRION Universe`);
            if (ogDescription) ogDescription.setAttribute('content', program.description || 'PATRION Program Details');
            
            const imageUrl = PatrionAPI.getImageUrl(program.thumbnail || program.image);
            if (ogImage && imageUrl) ogImage.setAttribute('content', imageUrl);
            
            // Update Twitter cards
            const twitterTitle = document.querySelector('meta[name="twitter:title"]');
            const twitterDescription = document.querySelector('meta[name="twitter:description"]');
            const twitterImage = document.querySelector('meta[name="twitter:image"]');
            
            if (twitterTitle) twitterTitle.setAttribute('content', `${program.title} - PATRION Universe`);
            if (twitterDescription) twitterDescription.setAttribute('content', program.description || 'PATRION Program Details');
            if (twitterImage && imageUrl) twitterImage.setAttribute('content', imageUrl);
        }

        function updateHeroSection(program) {
            const heroImage = document.getElementById('heroImage');
            const platformBadge = document.getElementById('platformBadge');
            const statusBadge = document.getElementById('statusBadge');
            const ratingBadge = document.getElementById('ratingBadge');
            const programTitle = document.getElementById('programTitle');
            const programDescription = document.getElementById('programDescription');
            const playTrailerBtn = document.getElementById('playTrailerBtn');
            const watchNowBtn = document.getElementById('watchNowBtn');
            
            // Set hero image
            const imageUrl = PatrionAPI.getImageUrl(program.thumbnail || program.image);
            if (heroImage) {
                heroImage.src = imageUrl;
                heroImage.alt = program.title;
                heroImage.onerror = function() {
                    this.src = 'assets/images/default-program.png';
                };
            }
            
            if (programTitle) programTitle.textContent = program.title;
            if (programDescription) programDescription.textContent = program.description || '';
            
            // Platform badge
            let platformClass = '';
            let platformText = program.platform || 'Digital';
            switch ((program.platform || '').toLowerCase()) {
                case 'cinema': platformClass = 'bg-red-900/30 text-red-300'; break;
                case 'ott':
                case 'streaming': platformClass = 'bg-green-900/30 text-green-300'; break;
                case 'digital':
                case 'web': platformClass = 'bg-blue-900/30 text-blue-300'; break;
                case 'tv': platformClass = 'bg-purple-900/30 text-purple-300'; break;
                default: platformClass = 'bg-gray-800/30 text-gray-300';
            }
            
            if (platformBadge) {
                platformBadge.className = `${platformClass} px-4 py-1 rounded-full text-sm font-semibold`;
                platformBadge.textContent = platformText.toUpperCase();
            }
            
            // Status badge
            let statusClass = '';
            let statusText = '';
            switch ((program.status || '').toLowerCase()) {
                case 'upcoming':
                    statusClass = 'bg-yellow-900/30 text-yellow-300';
                    statusText = 'COMING SOON';
                    break;
                case 'released':
                case 'completed':
                    statusClass = 'bg-green-900/30 text-green-300';
                    statusText = 'AVAILABLE';
                    break;
                case 'production':
                    statusClass = 'bg-blue-900/30 text-blue-300';
                    statusText = 'IN PRODUCTION';
                    break;
                default:
                    statusClass = 'bg-gray-800/30 text-gray-300';
                    statusText = 'TBA';
            }
            
            if (statusBadge) {
                statusBadge.className = `${statusClass} px-4 py-1 rounded-full text-sm font-semibold`;
                statusBadge.textContent = statusText;
            }
            
            // Rating badge
            if (ratingBadge) {
                ratingBadge.textContent = program.rating || 'PG';
            }
            
            // Play trailer button
            if (playTrailerBtn) {
                if (program.trailer) {
                    playTrailerBtn.onclick = () => playTrailerModal(program);
                    playTrailerBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Play Trailer';
                    playTrailerBtn.disabled = false;
                } else {
                    playTrailerBtn.innerHTML = '<i class="fas fa-ban mr-2"></i> No Trailer';
                    playTrailerBtn.disabled = true;
                }
            }
            
            // Watch now button
            if (watchNowBtn) {
                if (program.status === 'released' || program.status === 'completed') {
                    watchNowBtn.innerHTML = '<i class="fas fa-eye mr-2"></i> Watch Now';
                    watchNowBtn.onclick = () => {
                        if (program.watch_url) {
                            window.open(program.watch_url, '_blank');
                        } else {
                            alert('Watch link not available yet.');
                        }
                    };
                } else {
                    watchNowBtn.innerHTML = '<i class="far fa-bell mr-2"></i> Notify Me';
                    watchNowBtn.onclick = () => notifyMe(program);
                }
            }
        }

        function updateOverviewTab(program) {
            const synopsis = document.getElementById('synopsis');
            const detailTrailer = document.getElementById('detailTrailer');
            const detailReleaseDate = document.getElementById('detailReleaseDate');
            const detailDuration = document.getElementById('detailDuration');
            const detailEpisodes = document.getElementById('detailEpisodes');
            const detailBudget = document.getElementById('detailBudget');
            const platforms = document.getElementById('platforms');
            
            // Synopsis
            if (synopsis) {
                synopsis.innerHTML = program.synopsis ?
                    program.synopsis.split('\n').map(p => `<p class="mb-4">${p}</p>`).join('') :
                    `<p class="text-gray-400 italic">No synopsis available yet.</p>`;
            }
            
            // Trailer video
            if (detailTrailer) {
                if (program.trailer) {
                    const trailerUrl = PatrionAPI.getTrailerUrl(program.trailer);
                    const imageUrl = PatrionAPI.getImageUrl(program.thumbnail || program.image);
                    
                    detailTrailer.src = trailerUrl;
                    detailTrailer.poster = imageUrl;
                    detailTrailer.innerHTML = `
                        <source src="${trailerUrl}" type="video/mp4">
                        Your browser does not support the video tag.
                    `;
                    detailTrailer.style.display = 'block';
                } else {
                    detailTrailer.style.display = 'none';
                }
            }
            
            // Details
            if (detailReleaseDate) detailReleaseDate.textContent = program.release_date || program.releaseDate || 'TBA';
            if (detailDuration) detailDuration.textContent = program.duration || 'N/A';
            if (detailEpisodes) detailEpisodes.textContent = program.episodes || '1';
            if (detailBudget) detailBudget.textContent = program.budget || 'N/A';
            
            // Platforms
            if (platforms) {
                if (program.platforms && program.platforms.length > 0) {
                    platforms.innerHTML = program.platforms.map(p => `
                        <div class="flex items-center space-x-3 mb-3">
                            <div class="platform-${p.type || 'digital'} platform-icon text-white">
                                <i class="${p.icon || 'fas fa-globe'}"></i>
                            </div>
                            <div>
                                <div class="text-white font-medium">${p.name}</div>
                                <div class="text-gray-400 text-sm">${(p.type || 'digital').toUpperCase()}</div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    // Default platform based on program type
                    let platformType = program.platform || 'digital';
                    let platformIcon = 'fas fa-globe';
                    let platformName = program.platform || 'Digital Platform';
                    
                    switch (platformType.toLowerCase()) {
                        case 'cinema': platformIcon = 'fas fa-film'; break;
                        case 'ott':
                        case 'streaming': platformIcon = 'fas fa-tv'; break;
                        case 'tv': platformIcon = 'fas fa-satellite-dish'; break;
                    }
                    
                    platforms.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <div class="platform-${platformType} platform-icon text-white">
                                <i class="${platformIcon}"></i>
                            </div>
                            <div>
                                <div class="text-white font-medium">${platformName}</div>
                                <div class="text-gray-400 text-sm">${platformType.toUpperCase()}</div>
                            </div>
                        </div>
                    `;
                }
            }
        }

        async function loadAdditionalData(program) {
            try {
                // Load characters
                const characters = await PatrionAPI.getCharacters();
                updateCharactersContent(program, characters);
                
                // Load episodes if available
                updateEpisodesContent(program);
                
                // Load related programs
                await loadRelatedPrograms(program);
                
                // Initialize other tabs
                initializeProductionTab(program);
                initializeGalleryTab(program);
                
            } catch (error) {
                // console.error('Failed to load additional data:', error);
            }
        }

        function updateCharactersContent(program, allCharacters) {
            const featuredCharacters = document.getElementById('featuredCharacters');
            const allCharactersContainer = document.getElementById('allCharacters');
            
            // Filter characters related to this program
            const programCharacterIds = program.characters || [];
            const relatedCharacters = allCharacters.filter(char =>
                programCharacterIds.includes(char.id) ||
                programCharacterIds.includes(char.slug) ||
                (program.character_ids && program.character_ids.includes(char.id))
            );
            
            // Featured characters (first 4)
            if (featuredCharacters) {
                if (relatedCharacters.length > 0) {
                    featuredCharacters.innerHTML = relatedCharacters.slice(0, 4).map(char => {
                        const imageUrl = PatrionAPI.getImageUrl(char.image);
                        return `
                            <div class="character-card rounded-lg overflow-hidden cursor-pointer"
                                onclick="window.location.href='character-detail.html?character=${char.slug || char.id}'">
                                <img src="${imageUrl}" 
                                    alt="${char.name}" 
                                    class="w-full h-40 object-cover"
                                    loading="lazy"
                                    onerror="this.src='assets/images/default-character.png'">
                                <div class="p-3">
                                    <h4 class="fantasy-font text-white text-sm">${char.name}</h4>
                                    <p class="text-gray-400 text-xs mt-1">${char.region || 'Nusantara'}</p>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    featuredCharacters.innerHTML = `
                        <div class="col-span-full text-center py-8 text-gray-400">
                            <i class="fas fa-users text-3xl mb-2"></i>
                            <p>Character information coming soon</p>
                        </div>
                    `;
                }
            }
            
            // All characters
            if (allCharactersContainer) {
                if (relatedCharacters.length > 0) {
                    allCharactersContainer.innerHTML = relatedCharacters.map(char => {
                        const imageUrl = PatrionAPI.getImageUrl(char.image);
                        return `
                            <div class="character-card rounded-lg overflow-hidden text-center cursor-pointer"
                                onclick="window.location.href='character-detail.html?character=${char.slug || char.id}'">
                                <img src="${imageUrl}" 
                                    alt="${char.name}" 
                                    class="w-full h-48 object-cover"
                                    loading="lazy"
                                    onerror="this.src='assets/images/default-character.png'">
                                <div class="p-3">
                                    <h4 class="fantasy-font text-white">${char.name}</h4>
                                    <div class="flex items-center justify-center mt-2">
                                        <span class="element-badge ${char.element || 'fire'} px-3 py-1 rounded-full text-xs">
                                            ${(char.element || 'fire').toUpperCase()}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    allCharactersContainer.innerHTML = `
                        <div class="col-span-full text-center py-8 text-gray-400">
                            <i class="fas fa-users text-3xl mb-2"></i>
                            <p>No characters assigned to this program yet</p>
                        </div>
                    `;
                }
            }
        }

        function updateEpisodesContent(program) {
            const episodesList = document.getElementById('episodesList');
            
            if (episodesList) {
                if (program.episodes_data && program.episodes_data.length > 0) {
                    episodesList.innerHTML = program.episodes_data.map((ep, index) => `
                        <div class="episode-card p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all">
                            <div class="flex items-start justify-between">
                                <div class="flex items-start space-x-4">
                                    <div class="flex-shrink-0 w-12 h-12 bg-fantasy-gold/10 rounded-lg flex items-center justify-center">
                                        <span class="fantasy-font text-fantasy-gold font-bold">${index + 1}</span>
                                    </div>
                                    <div>
                                        <h4 class="text-white font-medium mb-1">${ep.title || `Episode ${index + 1}`}</h4>
                                        <p class="text-gray-400 text-sm">${ep.description || 'No description available'}</p>
                                        <div class="flex items-center space-x-4 mt-2">
                                            <span class="text-gray-500 text-xs">
                                                <i class="far fa-clock mr-1"></i>${ep.duration || 'N/A'}
                                            </span>
                                            ${ep.aired_date ? `
                                                <span class="text-gray-500 text-xs">
                                                    <i class="far fa-calendar mr-1"></i>${ep.aired_date}
                                                </span>
                                            ` : ''}
                                        </div>
                                    </div>
                                </div>
                                ${ep.video_url ? `
                                    <button class="text-fantasy-gold hover:text-yellow-300" onclick="playEpisode('${ep.video_url}')">
                                        <i class="fas fa-play-circle text-xl"></i>
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    `).join('');
                } else if (program.episodes && program.episodes > 1) {
                    // Generate placeholder episodes
                    episodesList.innerHTML = `
                        <div class="text-center py-8 text-gray-400">
                            <i class="fas fa-list-ol text-3xl mb-2"></i>
                            <p>Episode list will be available soon</p>
                        </div>
                    `;
                } else {
                    // Single episode/movie
                    episodesList.innerHTML = `
                        <div class="episode-card p-4 rounded-lg">
                            <div class="text-center py-8">
                                <i class="fas fa-film text-3xl text-fantasy-gold mb-2"></i>
                                <h4 class="text-white font-medium mb-1">Feature Length Program</h4>
                                <p class="text-gray-400 text-sm">This is a single feature-length program</p>
                            </div>
                        </div>
                    `;
                }
            }
        }

        async function loadRelatedPrograms(program) {
            const relatedProgramsContainer = document.getElementById('relatedPrograms');
            if (!relatedProgramsContainer) return;
            
            try {
                const allPrograms = await PatrionAPI.getPrograms();
                
                // Filter related programs (same platform or category, exclude current)
                const related = allPrograms
                    .filter(p => p.id !== program.id &&
                        (p.platform === program.platform ||
                            p.category === program.category))
                    .slice(0, 4);
                
                if (related.length > 0) {
                    relatedProgramsContainer.innerHTML = related.map(p => {
                        const imageUrl = PatrionAPI.getImageUrl(p.thumbnail || p.image);
                        return `
                            <div class="glass-effect rounded-lg overflow-hidden hover:shadow-xl transition-all cursor-pointer" 
                                onclick="window.location.href='program-detail.html?slug=${p.slug || p.id}'">
                                <img src="${imageUrl}" 
                                    alt="${p.title}" 
                                    class="w-full h-40 object-cover"
                                    loading="lazy"
                                    onerror="this.src='assets/images/default-program.png'">
                                <div class="p-4">
                                    <h4 class="fantasy-font text-white text-lg mb-2 line-clamp-2">${p.title}</h4>
                                    <p class="text-gray-400 text-sm mb-3 line-clamp-2">${p.description || ''}</p>
                                    <div class="flex justify-between items-center">
                                        <span class="text-fantasy-gold text-sm font-medium">${(p.platform || 'digital').toUpperCase()}</span>
                                        <span class="text-gray-500 text-sm">${p.release_date || 'TBA'}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    relatedProgramsContainer.innerHTML = `
                        <div class="col-span-full text-center py-8 text-gray-400">
                            <i class="fas fa-film text-3xl mb-2"></i>
                            <p>No related programs found</p>
                        </div>
                    `;
                }
            } catch (error) {
                // console.error('Failed to load related programs:', error);
                relatedProgramsContainer.innerHTML = `
                    <div class="col-span-full text-center py-8 text-gray-400">
                        <p>Unable to load related programs</p>
                    </div>
                `;
            }
        }

        function initializeProductionTab(program) {
            const productionDetails = document.getElementById('productionDetails');
            const productionTimeline = document.getElementById('productionTimeline');
            const crewList = document.getElementById('crewList');
            
            if (productionDetails) {
                productionDetails.innerHTML = `
                    <div class="glass-effect p-4 rounded-lg">
                        <h4 class="text-white font-semibold mb-2">Studio</h4>
                        <p class="text-gray-300">${program.production_studio || 'Patrion Animation Studio'}</p>
                    </div>
                    <div class="glass-effect p-4 rounded-lg">
                        <h4 class="text-white font-semibold mb-2">Director</h4>
                        <p class="text-gray-300">${program.director || 'Abdurrahman GM'}</p>
                    </div>
                    <div class="glass-effect p-4 rounded-lg">
                        <h4 class="text-white font-semibold mb-2">Budget</h4>
                        <p class="text-gray-300">${program.budget || 'N/A'}</p>
                    </div>
                    <div class="glass-effect p-4 rounded-lg">
                        <h4 class="text-white font-semibold mb-2">Production Timeline</h4>
                        <p class="text-gray-300">${program.production_timeline || 'In development'}</p>
                    </div>
                `;
            }
            
            if (productionTimeline) {
                productionTimeline.innerHTML = `
                    <div class="relative">
                        <div class="absolute left-4 top-0 bottom-0 w-0.5 bg-fantasy-gold/30"></div>
                        <div class="space-y-6">
                            <div class="flex items-start">
                                <div class="w-8 h-8 rounded-full bg-fantasy-gold flex-shrink-0 mr-4 flex items-center justify-center">
                                    <i class="fas fa-check text-black text-sm"></i>
                                </div>
                                <div>
                                    <h4 class="text-white font-semibold">Pre-production</h4>
                                    <p class="text-gray-400 text-sm">Script, Concept Art, Casting</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="w-8 h-8 rounded-full ${program.status === 'released' || program.status === 'completed' ? 'bg-fantasy-gold' : program.status === 'production' ? 'bg-yellow-500' : 'bg-gray-700'} flex-shrink-0 mr-4 flex items-center justify-center">
                                    <i class="fas ${program.status === 'released' || program.status === 'completed' ? 'fa-check' : program.status === 'production' ? 'fa-spinner' : 'fa-clock'} text-black text-sm"></i>
                                </div>
                                <div>
                                    <h4 class="text-white font-semibold">Production</h4>
                                    <p class="text-gray-400 text-sm">${program.status === 'released' || program.status === 'completed' ? 'Completed' : program.status === 'production' ? 'In Progress' : 'Scheduled'}</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="w-8 h-8 rounded-full ${program.status === 'released' || program.status === 'completed' ? 'bg-fantasy-gold' : 'bg-gray-700'} flex-shrink-0 mr-4 flex items-center justify-center">
                                    <i class="fas ${program.status === 'released' || program.status === 'completed' ? 'fa-check' : 'fa-clock'} text-black text-sm"></i>
                                </div>
                                <div>
                                    <h4 class="text-white font-semibold">Post-production</h4>
                                    <p class="text-gray-400 text-sm">${program.status === 'released' || program.status === 'completed' ? 'Completed' : 'Pending'}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            if (crewList) {
                const crew = program.crew || [
                    { role: 'Director', name: program.director || 'Abdurrahman GM' },
                    { role: 'Producer', name: 'Siti Nurhaliza' },
                    { role: 'Music Composer', name: 'Tulus' },
                    { role: 'Art Director', name: 'Budi Santoso' },
                    { role: 'VFX Supervisor', name: 'Citra Kirana' },
                    { role: 'Lead Writer', name: 'Dewi Lestari' }
                ];
                
                crewList.innerHTML = crew.map(member => `
                    <div class="glass-effect p-4 rounded-lg">
                        <h4 class="text-white font-semibold mb-2">${member.role}</h4>
                        <p class="text-gray-300">${member.name}</p>
                    </div>
                `).join('');
            }
        }

        function initializeGalleryTab(program) {
            const galleryGrid = document.getElementById('galleryGrid');
            
            if (galleryGrid) {
                if (program.gallery && program.gallery.length > 0) {
                    galleryGrid.innerHTML = program.gallery.map((item, index) => {
                        const imageUrl = PatrionAPI.getImageUrl(item.image || item.src);
                        return `
                            <div class="gallery-item cursor-pointer" data-type="${item.type || 'stills'}">
                                <img src="${imageUrl}" 
                                    alt="${item.caption || program.title}" 
                                    class="w-full h-48 object-cover rounded-lg hover:scale-105 transition-transform duration-300"
                                    loading="lazy"
                                    onerror="this.src='assets/images/default-program.png'"
                                    onclick="window.openImageModal('${imageUrl}', '${item.caption || program.title}')">
                                <p class="text-gray-400 text-sm mt-2 truncate">${item.caption || `Image ${index + 1}`}</p>
                            </div>
                        `;
                    }).join('');
                } else {
                    // Default gallery with program image
                    const imageUrl = PatrionAPI.getImageUrl(program.thumbnail || program.image);
                    galleryGrid.innerHTML = `
                        <div class="col-span-full text-center py-8 text-gray-400">
                            <i class="fas fa-images text-3xl mb-2"></i>
                            <p>Gallery coming soon</p>
                        </div>
                    `;
                }
            }
        }

        function setupEventListeners() {
            // Tab switching
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    // Update active tab button
                    document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Hide all tab panes
                    document.querySelectorAll('.tab-pane').forEach(pane => {
                        pane.classList.add('hidden');
                        pane.classList.remove('active');
                    });
                    
                    // Show selected tab
                    const selectedPane = document.getElementById(`${tabId}Tab`);
                    if (selectedPane) {
                        selectedPane.classList.remove('hidden');
                        selectedPane.classList.add('active');
                        selectedPane.classList.add('animate-fade-in');
                    }
                });
            });
            
            // Gallery filtering
            const filterGalleryBtns = document.querySelectorAll('.filter-gallery');
            if (filterGalleryBtns.length > 0) {
                filterGalleryBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const filter = this.dataset.filter;
                        
                        // Update active filter button
                        filterGalleryBtns.forEach(b => {
                            b.classList.remove('active', 'bg-fantasy-gold/20', 'text-fantasy-gold');
                            b.classList.add('glass-effect', 'text-gray-400');
                        });
                        this.classList.add('active', 'bg-fantasy-gold/20', 'text-fantasy-gold');
                        this.classList.remove('glass-effect', 'text-gray-400');
                        
                        // Filter gallery items
                        document.querySelectorAll('.gallery-item').forEach(item => {
                            if (filter === 'all' || item.dataset.type === filter) {
                                item.style.display = 'block';
                            } else {
                                item.style.display = 'none';
                            }
                        });
                    });
                });
            }
            
            // Add to list button
            const addToListBtn = document.getElementById('addToListBtn');
            if (addToListBtn) {
                addToListBtn.addEventListener('click', toggleWatchlist);
            }
            
            // Video modal
            const videoModal = document.getElementById('videoModal');
            const closeModal = document.getElementById('closeModal');
            
            if (closeModal) {
                closeModal.addEventListener('click', () => {
                    const video = document.getElementById('modalVideo');
                    video.pause();
                    videoModal.classList.add('hidden');
                });
            }
            
            // Image modal
            const imageModal = document.getElementById('imageModal');
            const closeImageModal = document.getElementById('closeImageModal');
            
            if (closeImageModal) {
                closeImageModal.addEventListener('click', () => {
                    imageModal.classList.add('hidden');
                });
            }
            
            // Close modals on background click
            if (videoModal) {
                videoModal.addEventListener('click', (e) => {
                    if (e.target === videoModal) {
                        const video = document.getElementById('modalVideo');
                        video.pause();
                        videoModal.classList.add('hidden');
                    }
                });
            }
            
            if (imageModal) {
                imageModal.addEventListener('click', (e) => {
                    if (e.target === imageModal) {
                        imageModal.classList.add('hidden');
                    }
                });
            }
        }

        function initializeBackToTop() {
            const backToTopBtn = document.getElementById('backToTop');
            
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) {
                    backToTopBtn.classList.add('visible');
                } else {
                    backToTopBtn.classList.remove('visible');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        }

        function notifyMe(program) {
            alert(`You'll be notified when "${program.title}" is released!`);
        }

        function toggleWatchlist() {
            const btn = document.getElementById('addToListBtn');
            if (btn.innerHTML.includes('bookmark')) {
                btn.innerHTML = '<i class="fas fa-bookmark mr-2"></i> Added to List';
                btn.classList.remove('border-gray-600', 'text-gray-300');
                btn.classList.add('border-fantasy-gold', 'text-fantasy-gold');
            } else {
                btn.innerHTML = '<i class="far fa-bookmark mr-2"></i> Add to List';
                btn.classList.remove('border-fantasy-gold', 'text-fantasy-gold');
                btn.classList.add('border-gray-600', 'text-gray-300');
            }
        }

        function playTrailerModal(program) {
            const trailerUrl = PatrionAPI.getTrailerUrl(program.trailer);
            if (!trailerUrl) {
                alert('Trailer not available');
                return;
            }
            
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('modalVideo');
            
            video.src = trailerUrl;
            modal.classList.remove('hidden');
            video.play().catch(e => {
                // console.error('Failed to play video:', e);
                alert('Unable to play trailer. Please try again.');
            });
        }

        function playEpisode(videoUrl) {
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('modalVideo');
            
            video.src = videoUrl;
            modal.classList.remove('hidden');
            video.play().catch(e => {
                // console.error('Failed to play episode:', e);
                alert('Unable to play episode. Please try again.');
            });
        }

        function openImageModal(imageSrc, caption) {
            const modal = document.getElementById('imageModal');
            const image = document.getElementById('modalImage');
            const imageCaption = document.getElementById('imageCaption');
            
            image.src = imageSrc;
            imageCaption.textContent = caption;
            modal.classList.remove('hidden');
        }

        function showNotFoundState() {
            const mainContent = document.querySelector('main');
            if (mainContent) {
                mainContent.innerHTML = `
                    <div class="container mx-auto px-4 py-16 text-center">
                        <i class="fas fa-exclamation-circle text-6xl text-yellow-500 mb-4"></i>
                        <h1 class="fantasy-font text-3xl text-white mb-4">Program Not Found</h1>
                        <p class="text-gray-400 mb-8">The program you're looking for doesn't exist or has been moved.</p>
                        <a href="program.html" class="bg-fantasy-gold hover:bg-yellow-500 text-black font-bold py-3 px-8 rounded-full inline-block">
                            <i class="fas fa-arrow-left mr-2"></i> Back to Programs
                        </a>
                    </div>
                `;
            }
        }

        function showErrorState() {
            const mainContent = document.querySelector('main');
            if (mainContent) {
                mainContent.innerHTML = `
                    <div class="container mx-auto px-4 py-16 text-center">
                        <i class="fas fa-exclamation-triangle text-6xl text-red-500 mb-4"></i>
                        <h1 class="fantasy-font text-3xl text-white mb-4">Loading Error</h1>
                        <p class="text-gray-400 mb-8">Failed to load program details. Please check your connection and try again.</p>
                        <div class="flex gap-4 justify-center">
                            <button onclick="location.reload()" class="bg-fantasy-gold hover:bg-yellow-500 text-black font-bold py-3 px-8 rounded-full">
                                <i class="fas fa-redo mr-2"></i> Try Again
                            </button>
                            <a href="program.html" class="border border-fantasy-gold text-fantasy-gold hover:bg-fantasy-gold hover:text-black font-bold py-3 px-8 rounded-full">
                                <i class="fas fa-arrow-left mr-2"></i> Back to Programs
                            </a>
                        </div>
                    </div>
                `;
            }
        }

        // Make functions globally available
        window.playTrailerModal = playTrailerModal;
        window.playEpisode = playEpisode;
        window.openImageModal = openImageModal;

        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // Main initialization
        document.addEventListener('DOMContentLoaded', async function () {
            try {
                // console.log('Initializing program detail page...');
                
                // Get program identifier from URL
                const urlParams = new URLSearchParams(window.location.search);
                const programId = urlParams.get('id');
                let programSlug = urlParams.get('slug');
                
                // console.log('URL Parameters:', { id: programId, slug: programSlug });
                
                let program = null;
                
                // Cari program berdasarkan ID atau slug
                if (programSlug) {
                    // Coba dengan slug
                    program = await PatrionAPI.getProgramBySlug(programSlug);
                } else if (programId) {
                    // Coba dengan ID
                    program = await PatrionAPI.getProgramById(programId);
                }
                
                if (!program) {
                    // console.log('Program not found, showing not found state');
                    showNotFoundState();
                    return;
                }
                
                // console.log('Found program:', program.title);
                
                // Store program globally
                window.currentProgram = program;
                
                // Update page with program data
                updatePageContent(program);
                
                // Load additional data
                await loadAdditionalData(program);
                
                // Setup UI components
                setupEventListeners();
                initializeBackToTop();
                
                // console.log('Program detail page initialized successfully');
                
            } catch (error) {
                // console.error('Failed to initialize program detail:', error);
                showErrorState();
            }
        });
    </script>

</body>
</html>